<!DOCTYPE html>
<html>
	<head>
	<style type="text/css">
		body {
			background: url(/img/spiderweb.jpg) no-repeat center center fixed;
			width: 100%;
			font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
			-webkit-background-size: cover;
			-moz-background-size: cover;
			-o-background-size: cover;
			background-size: cover;			
		}		
		#container {
			padding: 5%;
		}
	</style>
	</head>
	<body onload="setup();">

		<div id="container">
			<div id="clock">What time is it?</div>

			<br>
			<h4> Spider will drop at this time: </h4>
				<select name="hour" id='hour'>
				</select>
				<select name="minute" id='minute'>
				</select>
				<select name="second" id='second'>
				</select>
				<button onclick="dropAt()">submit</button>				
			
			<br>
			<h3> OR </h3>
			<h4> Spider will drop in this many hours / minutes / seconds: <h4>

			<input type="text" id="time">
			<select name="units" id='units'>
				<option name = 'hours' id='hours'>hour(s)</option>
				<option name = 'minutes' id='minutes'>minute(s)</option>
				<option name = 'seconds' id='seconds'>second(s)</option>
			</select>		
			<button onclick="dropIn()">submit</button>	
		</div>
		<script type="text/javascript">
			function setup() {
				// start the clock
				setInterval(tick, 1000);
				var hour = document.getElementById('hour');
				var hours = document.getElementById('hours');
				var seconds = document.getElementById('seconds');
				var minutes = document.getElementById('minutes');

				for(var i = 0; i < 24; i++){
					var option = document.createElement("option");
					var t = document.createTextNode(i);
					option.appendChild(t)
					option.value = i;

					hour.appendChild(option);
				}

				for(var i = 0; i < 60; i++){
					var option = document.createElement("option");
					var t = document.createTextNode(i);
					option.appendChild(t)
					option.value = i;

					minute.appendChild(option);
				}

				for(var i = 0; i < 6; i++){
					var option = document.createElement("option");
					var t = document.createTextNode(i*10);
					option.appendChild(t)
					option.value = i*10;

					second.appendChild(option);
				}								
			}
			
			function tick() {
				// get the div that the clock should be in:
				var myClock = document.getElementById('clock');
				if(myClock){
					var now = new Date();
					// put the date in the div:
					myClock.innerHTML = now;					
				}
			}

			function dropAt() {
				var request = new XMLHttpRequest();
				// GET /output/color/level, and make an asynchronous request:
				request.open( "GET", '/at/' + hour.value + "/" + minute.value + "/" + second.value, true );
				// close the request:
				request.send( null );

				request.onreadystatechange=function () {
					document.getElementById('container').innerHTML = request.responseText;
				} 

				// document.getElementById("container").innerHTML = request.responseText;										
			}

			function dropIn() {
				if(validateForm(time)){
					var request = new XMLHttpRequest();
					// GET /output/color/level, and make an asynchronous request:
					request.open( "GET", '/in/' + time.value + "/" + units.value, true );
					// close the request:
					request.send( null );		

					request.onreadystatechange=function () {
						document.getElementById('container').innerHTML = request.responseText;
					}	
				}
			
				
			}

			function validateForm(element) {
				var x = element.value;
				if (x == null || x == "") {
					alert("Enter a time, yo!");
					return false;
				}
				else return true;
			}			

		</script>		
	</body>
</html>